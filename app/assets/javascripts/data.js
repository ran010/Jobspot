var generateUUID;

$(document).on('turbolinks:load', function() {
  return $('body').on('click', '.export-btn', function(e) {
    var URL, uuid;
    uuid = generateUUID();
    $('.export-btn').html("Exporting...");
    $('.export-btn').addClass('disabled');
    URL = decodeURI(e.target.href + '?export_id=' + uuid);
    return window.ExportChannel.Subscribe(uuid, function() {
      $.get(encodeURI(URL));
    });
  });
});

generateUUID = function() {
  var d;
  d = new Date().getTime();
  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
    var r;
    r = (d + Math.random() * 16) % 16 | 0;
    d = Math.floor(d / 16);
    return (c === 'x' ? r : r & 0x3 | 0x8).toString(16);
  });
};

// ---
// generated by coffee-script 1.9.2